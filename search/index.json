[{"content":"起因 HyPlayer在24年的时候引入了 Win2D 作为新的歌词面板, 之前主力后端开发者写了一篇知乎文章做介绍。所以这边就先不讲大部分的初期的实现细节。 那讲啥呢？ 众所周知，在后期版本，为了 高度自定义 界面样式来 压榨 Win2D 的潜力，开发团队引入了字体自定义功能。问题也就出在这里。发版之后的那天晚上，我们用户群里就有人反馈，部分字体会导致高亮出错。具体表现就像是这篇Issue；唯一的不同是，这不是字与字之间的重叠问题。后经过确认，是在特定字体下，字体内部存在重叠，导致在上文提到的 Geometry 取交集的时候无法正确进行计算。重叠的部分于是出现了空洞。\n过程 这就比较麻烦了 不是吗？ 主要是因为高亮需要找到对应位置才能进行，不能硬做。但是Geometry肯定是不能作为后续方案了。幸运的是，我在查文档的时候看到了lindexi老师关于 CanvasActiveLayer 的文章。 在讲解决方案前，我们要先回忆一下刚刚的内容。歌词高亮/渐变的核心原理都是根据字生成一个Rect，作为高亮区域； 然后将生成的Rect和由字生成的 Geometry 取交集，然后再次绘制到画布上。这时候你应该已经想到了对应解决方案了，既然部分字体会导致 Geometry 在取交集的时候略过重叠部分导致字中出现空洞；那么，我们多次绘制字体，然后利用 CanvasActiveLayer 进行裁切，便可以达成同等的效果。（仍然是进行多次绘制，只不过一个绘制的是 Geometry ，另一个是 TextLayout。 Bug也就迎刃而解了。后来请教蓝火火，蓝火火说 Geometry 取交集是使用 CPU 进行计算，而 CanvasActiveLayer 是利用 GPU 的分层渲染；理论上性能会更高，但是我这里没有办法定量进行测试。于是这个只能先打一个问号。\n结果 这次的修复已经发到了 GitHub 上，只是因为最近一段时间没办法更新Blog，所以到现在才汇报。Blog到这里就结束了，Bye!\n","date":"2024-05-22T09:10:41Z","permalink":"https://blog.raspberrykan.dev/p/hyplayer-%E7%9A%84-win2d-%E6%AD%8C%E8%AF%8D%E9%9D%A2%E6%9D%BF%E7%9A%84%E5%90%8E%E6%9C%9F%E6%94%B9%E8%BF%9B/","title":"HyPlayer 的 Win2D 歌词面板的后期改进"},{"content":"部署起因 众所周知，我是一个怪人；毕竟 SoftEther 安装之后默认行为是不认证SSL证书，而且就算部署也不一定真的能用上。但是我还是想部署，主要是 (闲得慌) 想说好不容易买了个域名 (就不说我域名跑到帮我付钱的群友身上的事情了) 不上证书怎么行。但是Porkbun自带的Wildcard Certificates需要每三个月手动部署一次。(太麻烦了) 实质上也是Let\u0026rsquo;s Encrypt 签发的证书。所以干脆用Certbot DNS Challenge直接签发，还能用systemd的Timer自动触发证书更新。何乐而不为？\n部署过程 我走的路线是用 Certbot 的 snap 包以及 infinityofspace 开发的 snap Plugin (口口声声说不喜欢 snap 实际上真到想偷懒的时候还是直接上了 snap 我感觉我有点傲娇了)。然后就是不停试错，记得证书文件夹给个755权限，免得vpncmd读不到（我也不知道为啥最开始死活读不到，给了755就行了。但是执行者是root啊，怪欸。）\n部署结果和工具 还是很顺利地部署上了要是没有就不会有这篇 blog 了 这次所用到的脚本已经使用Unlicense license开源在GitHub，欢迎各位大佬前来参观和批评指正\n","date":"2024-05-22T09:10:41Z","permalink":"https://blog.raspberrykan.dev/p/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%B0%86softether%E9%83%A8%E7%BD%B2lets-encrypt%E7%9A%84%E8%BF%87%E7%A8%8B/","title":"记一次将SoftEther部署Let's Encrypt的过程"},{"content":"久违的开始更新个人站了。上一次更新的时候还是小学的事情 买了个叫做raspberrymonster.top的域名刺客\n最开始也不知道用啥库，原本想着用 Gridea 但是发现它似乎没有活跃更新了？\n然后看了看 WordPress 再看看我不充裕的钱包 不好意思打扰了\n再看了下 Hexo node_modules的质量比黑洞还大 遂放弃\n于是选择了 Hugo 另一方面是之前仰慕的一个技术大佬 Tinko Liu 从WordPress迁移之后也用着这个 Hugo 主题，我觉得很好看于是直接 拿来主义 了。 顺便也能提升我的Markdown能力，不是吗？\n于是乎，我的个人站回归了。\n芜湖！\n","date":"2024-05-22T08:49:05Z","permalink":"https://blog.raspberrykan.dev/p/%E5%AD%A9%E5%AD%90%E4%BB%AC%E6%88%91%E5%9B%9E%E6%9D%A5%E4%BA%86/","title":"孩子们，我回来了"}]